cmake_minimum_required(VERSION 3.5) 

set(ROCM_PATH /opt/rocm CACHE PATH " default ROCm installation path")
if(NOT DEFINED HIP_PATH)
    if(NOT DEFINED ENV{HIP_PATH})
      set(HIP_PATH "/opt/rocm/hip" CACHE PATH "Path to which HIP has been installed")
    else()
        set(HIP_PATH $ENV{HIP_PATH} CACHE PATH "Path to which HIP has been installed")
    endif()
endif()
set(CMAKE_MODULE_PATH "${HIP_PATH}/cmake" ${CMAKE_MODULE_PATH})

project(hipvx_sample)
set (CMAKE_CXX_STANDARD 14)

find_package(HIP QUIET)
if(HIP_FOUND)
    message(STATUS "Found HIP: " ${HIP_VERSION})
else()
    message(FATAL_ERROR "Could not find HIP. Ensure that HIP is either installed in /opt/rocm/hip or the variable HIP_PATH is set to point to the right location.")
endif()

message("CMAKE source dir ${CMAKE_SOURCE_DIR}")
include_directories (/opt/rocm/mivisionx/include ${HIP_PATH}/include ${HIP_PATH}/../include)
#link_directories(${CMAKE_SOURCE_DIR}/lib ${HIP_PATH}/lib)
link_directories(/opt/rocm/mivisionx/lib ${HIP_PATH}/lib)
hip_add_executable(hipvx_sample main.cpp)
target_link_libraries(hipvx_sample openvx hip_hcc pthread)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++14 -msse4.2")
#target_compile_definitions(hiprtc_test PRIVATE __HIP_PLATFORM_HCC__)
